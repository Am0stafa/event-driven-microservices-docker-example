syntax = "proto3";
import "google/protobuf/timestamp.proto";

// Service Interface...

service ArticleManagementService {
    rpc addArticle (ArticleRequest) returns (ArticleResponse);
    rpc addImage (stream AddImageRequest) returns (GenericResponse);
    rpc deleteArticle (ArticleUIDRequest) returns (GenericResponse);
    rpc getArticle (ArticleUIDRequest) returns (ArticleResponse);
    rpc getAll (EmptyRequest) returns (stream ArticleResponse);
    rpc getAllPendingVerificationArticles (EmptyRequest) returns (stream ArticleResponse);
    rpc verifyArticle (ArticleUIDRequest) returns (GenericResponse);
    rpc rejectArticle (ArticleUIDRequest) returns (GenericResponse);
}

// Entities...

message Article {
    string uid = 1;
    string title = 2;
    string description = 3;
    string body = 4;
    int32 likes = 5;
    bool status = 6;
    google.protobuf.Timestamp createdTimeStamp = 6;
    repeated Tag tags = 7;
    repeated Image images = 8;
}

message Image {
    bytes data = 1;
}

message Tag {
    string text = 1;
}

// Requests - Responses...

message ArticleUIDRequest {
    required string uid = 1;
}

message ArticleResponse {
    Article article = 1;
}

message ArticleRequest {
    required string title = 1;
    required string description = 2;
    required string body = 3;
    optional repeated Tag tags = 4;
    optional repeated Image images = 5;
}

message AddImageRequest {
    string articleUID = 1;
    bytes data = 2;
}

message EmptyRequest {}

message GenericResponse {
    bool isOk = 1;
}